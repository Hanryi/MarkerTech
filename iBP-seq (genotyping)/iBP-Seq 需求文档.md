# 需求描述

根据 barcode 文件、突变位点信息、参考序列和使用 iBP-Seq 产生的二代双端测序数据，分析出二倍体实验群体内每个样本在突变位点的基因型信息。其中各项文件说明如下：

1.  barcode 文件应以可读的文本文件的格式存在，文件内存放无重复的若干 8bp barcode 序列，序列之间以换行符分隔，barcode 序列的数量应与实验样本数量相同，排列顺序也应与实验中排列的样本顺序相同，每个 barcode 序列仅与一个实验样本对应；
2. 突变位点信息允许以 csv 或 txt 等可读的文本文件形式存在且各行之间要以英文逗号 ',' 分隔，或以 xlsx 表格文件格式存在，文件有表头 (CHROM, POS, REF, ALT) ，除表头外的四列数据分别为染色体名称，SNP 标记的突变位置或 InDel 标记第一个碱基的位置，未突变的参考标记序列，突变后的标记序列；
3. 参考序列文件一般以 fa 文件格式存在且要遵循 fasta 文件规范，参考序列需要覆盖所有突变位点。

## 输入示例

barcode 文件

~~~
ATCACGTT
CGATGTTT
TTAGGCAT
...
CCTCCGTT
TGCTTGCG
~~~

mutation.csv 文件

~~~
CHROM,POS,REF,ALT
zong31,28,GCCG,GCCGGA
zong31,443,ATG,A
~~~

参考序列文件

~~~
>zong31
CACGAGATCGCGCTTCGGGTCGTTCGTGCCGGATGCACCGAGGTACTCTTCCGGGCGTTCGCCAACGCTCCCTGCGATGTGCTAGACAGGTAACTTCGACGCTTCTGGTTTCTCTGGCTTCCTGCTGGTGAATGGATTTCCATGCTCGGATGTGACTGAGTGACGACGATCACGGTGCAGTTTCTTGTCAATTCTTCGGGTCGAATGCTCGCAGCAGACGACTGAGGCCGTGATCAAGCGGTGGACGACGGTGACGGAGATCATAGGGAAGGCCATGGTCGCCATGCGGAGGCAGCTGTACGCGCAGAACCCAGGCGCCTTCGACGGTTTCAGGGACGAATACTTGCTGGCCATCGCGGAGAACCGCATCCTGATCCTGCTCGACTTCGCCAACGGATTCACCAGCATCACGTCGCACGAGAAGCTCGTGTACATGCTCGGCATGTACGAGGCTCTCACCGACGCCGCTCCCAGCCTCCTGCTCCTCCTCAGCGGCGCGCGCAAGGAGGCCATCTCGGAGCGGACACAAGGTATCCTCACGAAACTGGCCGGCGCGGTGAGGATCATGGTCAGCGGCGCCATAGCCAAGATCCAAGGCGACTCACTGTTCCCGCACACGCCGAGCGCCGCAGGTGGCGTCCACCCGCTGACACGCAACGCCATGACCTGCGTCGAGCTGCTGGCGAGGCACCGCACCACGCTCGATCTGATCCTCGCGGGCGCCGACGAGCGCAGCTCCCTCGCCGGCGTCGTCTCGGACCTGATCGCGGGCCTGGAACGCAACCTCCAGAGGAGATT
~~~

此处省略双端测序数据的输入示例

## 分析要点

将混合测序数据拆分为若干不同样本的测序数据时要求识别 barcode 序列时要求精确匹配，而在识别 bridge 序列时要求最多存在一个碱基的错配。完成样本识别的 reads 要先将 barcode, bridge, UMI 和对应的质量值字符串都去掉，再输出到相应的文件

测序数据比对参考序列后，根据 read ID 在 BAM 文件与 Fastq 文件之间建立关联，以统计各标记的等位基因频率

## 预期输出

高可信度的基因分型或甲基化分型结果